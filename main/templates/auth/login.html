{% extends 'base.html' %}

{% block title %}GiriÅŸ Yap - Made in Izmir{% endblock %}

{% block body_class %}auth-page{% endblock %}

{% block content %}
<div class="login-container">
    <div class="auth-card">
        <h2 data-i18n="login.title">GiriÅŸ Yap</h2>
        <p class="auth-subtitle" data-i18n="login.subtitle">HesabÄ±nÄ±za giriÅŸ yapÄ±n</p>

        {% if messages %}
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }}">{{ message }}</div>
        {% endfor %}
        {% endif %}

        {% if form.non_field_errors %}
        <div class="non-field-error">{{ form.non_field_errors.0 }}</div>
        {% endif %}

        <form method="post" id="loginForm" novalidate autocomplete="on">
            {% csrf_token %}

            <div class="form-group">
                <label for="{{ form.username.id_for_label }}">
                    <span data-i18n="login.username">KullanÄ±cÄ± AdÄ± veya E-posta</span>
                    <span class="required">*</span>
                </label>
                <input type="text"
                       name="username"
                       id="{{ form.username.id_for_label }}"
                       class="form-control{% if form.username.errors %} is-invalid{% endif %}"
                       autocomplete="username email"
                       autofocus
                       required
                       value="{{ form.username.value|default:'' }}">
                {% if form.username.errors %}
                <div class="error-message">{{ form.username.errors.0 }}</div>
                {% endif %}
            </div>

            <div class="form-group">
                <label for="{{ form.password.id_for_label }}">
                    <span data-i18n="login.password">Åifre</span>
                    <span class="required">*</span>
                </label>
                <div class="input-wrapper">
                    <input type="password"
                           name="password"
                           id="{{ form.password.id_for_label }}"
                           class="form-control{% if form.password.errors %} is-invalid{% endif %}"
                           autocomplete="current-password"
                           required>
                    <button type="button" class="btn-eye" id="togglePwd" aria-label="Åifreyi gÃ¶ster/gizle" tabindex="-1">
                        ğŸ‘
                    </button>
                </div>
                {% if form.password.errors %}
                <div class="error-message">{{ form.password.errors.0 }}</div>
                {% endif %}
                <div class="forgot-password-link">
                    <a href="{% url 'password_reset' %}" data-i18n="login.forgot_password">Åifremi Unuttum?</a>
                </div>
            </div>

            <button type="submit" class="btn-auth" id="loginBtn" data-i18n="login.submit">GiriÅŸ Yap</button>
        </form>

        <div class="link-text">
            <span data-i18n="login.no_account">HesabÄ±nÄ±z yok mu?</span>
            <a href="{% url 'main:signup' %}" data-i18n="login.signup_link">KayÄ±t Olun</a>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function () {
    // Eye toggle
    const toggleBtn = document.getElementById('togglePwd');
    const pwdInput  = document.getElementById('{{ form.password.id_for_label }}');
    if (toggleBtn && pwdInput) {
        toggleBtn.addEventListener('click', function () {
            const isPassword = pwdInput.type === 'password';
            pwdInput.type = isPassword ? 'text' : 'password';
            this.textContent = isPassword ? 'ğŸ™ˆ' : 'ğŸ‘';
        });
    }

    // Loading state on submit
    const form = document.getElementById('loginForm');
    const btn  = document.getElementById('loginBtn');
    if (form && btn) {
        form.addEventListener('submit', function () {
            btn.classList.add('loading');
            btn.disabled = true;
        });
    }
});
</script>
{% endblock %}