{% extends 'base.html' %}

{% block title %}Kayıt Ol - Made in Izmir{% endblock %}

{% block body_class %}auth-page{% endblock %}

{% block content %}
<div class="signup-container">
    <div class="auth-card">
        <h2 data-i18n="signup.title">Kayıt Ol</h2>

        {% if messages %}
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }}">
            {{ message }}
        </div>
        {% endfor %}
        {% endif %}

        <form method="post" id="signupForm">
            {% csrf_token %}

            <!-- Personal Information -->
            <div class="form-section">
                <h3 data-i18n="signup.personal_info">Kişisel Bilgiler</h3>

                <div class="form-group">
                    <label for="{{ form.first_name.id_for_label }}">
                        <span data-i18n="signup.first_name">Ad</span> <span class="required">*</span>
                    </label>
                    {{ form.first_name }}
                    {% if form.first_name.errors %}
                    <div class="error-message">{{ form.first_name.errors.0 }}</div>
                    {% endif %}
                </div>

                <div class="form-group">
                    <label for="{{ form.last_name.id_for_label }}">
                        <span data-i18n="signup.last_name">Soyad</span> <span class="required">*</span>
                    </label>
                    {{ form.last_name }}
                    {% if form.last_name.errors %}
                    <div class="error-message">{{ form.last_name.errors.0 }}</div>
                    {% endif %}
                </div>

                <div class="form-group">
                    <label for="{{ form.email.id_for_label }}">
                        <span data-i18n="signup.email">E-posta</span> <span class="required">*</span>
                    </label>
                    {{ form.email }}
                    {% if form.email.errors %}
                    <div class="error-message">{{ form.email.errors.0 }}</div>
                    {% endif %}
                </div>

                <div class="form-group">
                    <label for="{{ form.username.id_for_label }}">
                        <span data-i18n="signup.username">Kullanıcı Adı</span> <span class="required">*</span>
                    </label>
                    {{ form.username }}
                    {% if form.username.errors %}
                    <div class="error-message">{{ form.username.errors.0 }}</div>
                    {% endif %}
                </div>

                <div class="form-group">
                    <label for="{{ form.password1.id_for_label }}">
                        <span data-i18n="signup.password">Şifre</span> <span class="required">*</span>
                    </label>
                    {{ form.password1 }}
                    {% if form.password1.errors %}
                    <div class="error-message">{{ form.password1.errors.0 }}</div>
                    {% endif %}
                </div>

                <div class="form-group">
                    <label for="{{ form.password2.id_for_label }}">
                        <span data-i18n="signup.password_confirm">Şifre Tekrar</span> <span class="required">*</span>
                    </label>
                    {{ form.password2 }}
                    {% if form.password2.errors %}
                    <div class="error-message">{{ form.password2.errors.0 }}</div>
                    {% endif %}
                </div>
            </div>

            <!-- Company Information -->
            <div class="form-section">
                <h3 data-i18n="signup.company_info">Firma Bilgileri</h3>

                <div class="form-group">
                    <label for="{{ form.company_name.id_for_label }}">
                        <span data-i18n="signup.company_name">Firma Adı</span> <span class="required">*</span>
                    </label>
                    {{ form.company_name }}
                    {% if form.company_name.errors %}
                    <div class="error-message">{{ form.company_name.errors.0 }}</div>
                    {% endif %}
                </div>

                <div class="form-group">
                    <label for="{{ form.phone_number.id_for_label }}">
                        <span data-i18n="signup.phone_number">Telefon Numarası</span> <span class="required">*</span>
                    </label>
                    {{ form.phone_number }}
                    {% if form.phone_number.errors %}
                    <div class="error-message">{{ form.phone_number.errors.0 }}</div>
                    {% endif %}
                </div>

                <div class="form-group">
                    <label for="{{ form.country.id_for_label }}">
                        <span data-i18n="signup.country">Ülke</span> <span class="required">*</span>
                    </label>
                    {{ form.country }}
                    {% if form.country.errors %}
                    <div class="error-message">{{ form.country.errors.0 }}</div>
                    {% endif %}
                </div>

                <div class="form-group">
                    <label for="{{ form.city.id_for_label }}">
                        <span data-i18n="signup.city">Şehir</span> <span class="required">*</span>
                    </label>
                    {{ form.city }}
                    {% if form.city.errors %}
                    <div class="error-message">{{ form.city.errors.0 }}</div>
                    {% endif %}
                </div>
            </div>

            <!-- User Type -->
            <div class="form-section">
                <h3 data-i18n="signup.user_type">Kullanıcı Tipi</h3>
                <p style="margin-bottom: 1rem; color: #666;" data-i18n="signup.user_type_desc">
                    En az bir seçenek seçmelisiniz. Her iki seçeneği de seçebilirsiniz.
                </p>

                <div class="form-check">
                    {{ form.is_buyer }}
                    <label class="form-check-label" for="{{ form.is_buyer.id_for_label }}">
                        <span data-i18n="signup.buyer">Alıcı</span>
                    </label>
                </div>

                <div class="form-check">
                    {{ form.is_producer }}
                    <label class="form-check-label" for="{{ form.is_producer.id_for_label }}">
                        <span data-i18n="signup.producer">Üretici</span>
                    </label>
                </div>

                {% if form.non_field_errors %}
                <div class="error-message">{{ form.non_field_errors.0 }}</div>
                {% endif %}
            </div>

            <!-- Buyer-specific fields -->
            <div id="buyerFields" class="conditional-fields">
                <h4 style="margin-bottom: 1rem;" data-i18n="signup.buyer_info">Alıcı Bilgileri</h4>

                <div class="form-group">
                    <label for="{{ form.buyer_interested_sectors.id_for_label }}">
                        <span data-i18n="signup.buyer_sectors">İlgilenilen Sektörler</span> <span
                            class="required">*</span>
                    </label>
                    {{ form.buyer_interested_sectors }}
                    <small style="color: #666;" data-i18n="signup.buyer_sectors_help">Virgülle ayırarak yazın (örn:
                        Tekstil, Gıda, Mermer)</small>
                    {% if form.buyer_interested_sectors.errors %}
                    <div class="error-message">{{ form.buyer_interested_sectors.errors.0 }}</div>
                    {% endif %}
                </div>

                <div class="form-group">
                    <label for="{{ form.buyer_quarterly_volume.id_for_label }}">
                        <span data-i18n="signup.buyer_volume">Çeyreklik Alım Hacmi (USD)</span> <span
                            class="required">*</span>
                    </label>
                    {{ form.buyer_quarterly_volume }}
                    {% if form.buyer_quarterly_volume.errors %}
                    <div class="error-message">{{ form.buyer_quarterly_volume.errors.0 }}</div>
                    {% endif %}
                </div>
            </div>

            <!-- Producer-specific fields -->
            <div id="producerFields" class="conditional-fields">
                <h4 style="margin-bottom: 1rem;" data-i18n="signup.producer_info">Üretici Bilgileri</h4>

                <div class="form-group">
                    <label for="{{ form.producer_sector.id_for_label }}">
                        <span data-i18n="signup.producer_sector">Sektör</span> <span class="required">*</span>
                    </label>
                    {{ form.producer_sector }}
                    {% if form.producer_sector.errors %}
                    <div class="error-message">{{ form.producer_sector.errors.0 }}</div>
                    {% endif %}
                </div>

                <div class="form-group">
                    <label for="{{ form.producer_quarterly_sales.id_for_label }}">
                        <span data-i18n="signup.producer_sales">Çeyreklik Satış Hacmi (USD)</span> <span
                            class="required">*</span>
                    </label>
                    {{ form.producer_quarterly_sales }}
                    {% if form.producer_quarterly_sales.errors %}
                    <div class="error-message">{{ form.producer_quarterly_sales.errors.0 }}</div>
                    {% endif %}
                </div>

                <div class="form-group">
                    <label for="{{ form.producer_product_count.id_for_label }}">
                        <span data-i18n="signup.producer_products">Yaklaşık Ürün Sayısı</span> <span
                            class="required">*</span>
                    </label>
                    {{ form.producer_product_count }}
                    {% if form.producer_product_count.errors %}
                    <div class="error-message">{{ form.producer_product_count.errors.0 }}</div>
                    {% endif %}
                </div>
            </div>

            <button type="submit" class="btn-auth" data-i18n="signup.submit">Kayıt Ol</button>
        </form>

        <div class="link-text">
            <span data-i18n="signup.have_account">Zaten hesabınız var mı?</span>
            <a href="{% url 'main:login' %}" data-i18n="signup.login_link">Giriş Yapın</a>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Show/hide conditional fields based on user type selection
    document.addEventListener('DOMContentLoaded', function () {
        const buyerCheckbox = document.getElementById('is_buyer');
        const producerCheckbox = document.getElementById('is_producer');
        const buyerFields = document.getElementById('buyerFields');
        const producerFields = document.getElementById('producerFields');

        function toggleFields() {
            if (buyerCheckbox.checked) {
                buyerFields.classList.add('active');
            } else {
                buyerFields.classList.remove('active');
            }

            if (producerCheckbox.checked) {
                producerFields.classList.add('active');
            } else {
                producerFields.classList.remove('active');
            }
        }

        // Initial check
        toggleFields();

        // Add event listeners
        buyerCheckbox.addEventListener('change', toggleFields);
        producerCheckbox.addEventListener('change', toggleFields);
    });
</script>
{% endblock %}